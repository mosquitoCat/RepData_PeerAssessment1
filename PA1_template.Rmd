title: "peer assessment 1"
============================
output: md_document


This is an R Markdown document for the peer assessment 1 of the Reprducible Research course. 

# Loading and preprocessing the data

Load the dataset from the course webset and transform the data into a format suitable for the analysis if necessary.

```{r}
## download the data file
temp <- tempfile()
download.file("http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip", temp)
## read in data 
data <- read.csv(unz(temp, "activity.csv"), header = TRUE)
summary(data)
head(data)
```

# What is mean total number of steps taken per day?

```{r}
library(plyr)
## Make a histogram of the total number of steps taken each day
## subset dataframe by date and sum the steps
data2 <- ddply(data, .(date), summarize, steps = sum(steps))
## Make a histogram with the new dataframe
hist(data2$steps, main = "Histogram of the total number of steps taken each day", xlab = "steps", col = "cyan")
## Calculate and report the mean and median total numbe of steps taken per day
mean <- mean(data2$steps, na.rm = TRUE)
median <- median(data2$steps, na.rm = TRUE)
cat("the mean total number of steps taken per day is: ", mean)
cat("the median total number of steps taken per day is:", median)
```

# What is the average daily activity pattern?

``` {r}
## Make a time series plot of the 5-minte interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
## Sorting the dataframe by the 5-minte interval and calculate the average to generate a new data frame data3
data3 <- ddply(data, .(interval), summarize, steps = mean(steps, na.rm = TRUE))
## time series plot
plot(data3$interval, data3$steps, xlab = "Interval", ylab = "Average number of steps", type = "l", col = "blue")
## find the 5-minte interval on average across all the days contains the maximum number of steps
intervalName <- data3$interval[which.max(data3$steps)]
cat("the 5-minte interval on average across all the days contains the maximum number of steps is:", intervalName)
```
# Imputing missing values

```{r}
data4 <- data
## Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)
nrow(data4[!complete.cases(data4), ])
## Devise a strategy for filling in all of the missing values in the dataset. The missing value will be filled with the mean for that 5-minute interval. 
## get index of NA values
index <- which(is.na(data4) == TRUE)
## find the mean for the 5-minute interval where the NA is by searching the data3 dataset with the mean of steps according to the interval
for (x in index) {
        data4[x, ]$steps = data3$steps[which(data3$interval == data4[x, ]$interval)]
}
## Make a histogram of the total number of steps taken each day
data5 <- ddply(data4, .(date), summarize, steps = sum(steps))
hist(data5$steps, main = "Histogram of the total number of steps taken each day", xlab = "steps", col = "red")
## and calculate and report the mean and median total number of steps taken per doy
mean <- mean(data5$steps, na.rm = TRUE)
median <- median(data5$steps, na.rm = TRUE)
cat("the mean total number of steps taken per day is: ", mean)
cat("the median total number of steps taken per day is:", median)
```
# Are there differences in activity pattern between weekdays and weekends?

```{r}
library(lattice)
## For this part the weekdays() function may be of some help here. Use the dataset with the filled-in missing values for this part, which is data4.
## Creat a new factor variable in the dataset with two levels - "weekday" and "weekend" indicating whether a given date is a weekday or weekend day.
data4$weekDay = weekdays(as.Date(data4$date))
data4[which(data4$weekDay == "Sunday" | data4$weekDay == "Saturday"), ]$weekDay = "weekend"
data4[which(data4$weekDay != "weekend"), ]$weekDay = "weekday"
## Make a panel plot containing a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all weekday days or weekend days (y-axis). 
data6 <- data4[which(data4$weekDay == "weekday"), ]
data6 <- ddply(data6, .(interval), summarize, steps = mean(steps, na.rm = TRUE))
data6$weekDay = "weekday"
data7 <- data4[which(data4$weekDay == "weekend"), ]
data7 <- ddply(data7, .(interval), summarize, steps = mean(steps, na.rm = TRUE))
data7$weekDay = "weekend"
data8 <- rbind(data6, data7)
xyplot(steps ~ interval | weekDay, data = data8, group = weekDay, layout = c(1, 2), type = "l")
```



